# proposal.py
import docxtpl, pdfkit, openai

def generate_proposal(data):
    tpl = docxtpl.DocxTemplate("template.docx")
    content = openai.ChatCompletion.create(
        model="gpt-4o-mini", messages=[...]
    ).choices[0].message.content
    tpl.render({'scope': content, **data['pricing']})
    tpl.save("out.docx")
    pdfkit.from_file("out.docx", "out.pdf")
    return "out.pdf"