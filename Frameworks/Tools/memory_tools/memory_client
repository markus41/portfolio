# memory_client.py
import requests

class MemoryClient:
    def __init__(self, base_url, token):
        self.base = base_url
        self.headers = {"Authorization": f"Bearer {token}"}

    def store(self, blob_uri, metadata):
        payload = {"blob_uri": blob_uri, "metadata": metadata}
        return requests.post(f"{self.base}/store", json=payload, headers=self.headers)

    def retrieve(self, query, k=6, filters=None):
        params = {"query": query, "k": k, "filters": filters or {}}
        return requests.get(f"{self.base}/retrieve", params=params, headers=self.headers).json()

    def forget(self, doc_id):
        return requests.post(f"{self.base}/forget", json={"doc_id": doc_id}, headers=self.headers)

    def push_fact(self, fact_json):
        return requests.post(f"{self.base}/push_fact", json=fact_json, headers=self.headers)