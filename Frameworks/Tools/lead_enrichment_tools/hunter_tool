# Tools/enrichment_tools/hunter_tool.py

import requests
from ..Engines.constants import HUNTER_API_KEY
from ..Engines.logger import get_logger

logger = get_logger(__name__)

class HunterTool:
    """
    Find email addresses and enrich by domain or company.
    """
    BASE_URL = "https://api.hunter.io/v2"

    def find_email(self, domain: str, first_name: str = None, last_name: str = None) -> dict:
        params = {"domain": domain, "api_key": HUNTER_API_KEY}
        if first_name: params["first_name"] = first_name
        if last_name:  params["last_name"]  = last_name
        logger.info(f"Hunter find_email for {first_name} {last_name}@{domain}")
        resp = requests.get(f"{self.BASE_URL}/email-finder", params=params)
        resp.raise_for_status()
        return resp.json()

    def enrich(self, email: str) -> dict:
        logger.info(f"Hunter enrich for {email}")
        resp = requests.get(f"{self.BASE_URL}/email-verifier", params={
            "email": email, "api_key": HUNTER_API_KEY
        })
        resp.raise_for_status()
        return resp.json()
